<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Arriendo de Box Médico por Hora — Interés</title>
  <meta name="description" content="Formulario de interés para médicos que buscan arriendo de box/consulta por hora en Santiago (Providencia, Las Condes, Ñuñoa, La Florida)." />
  <meta property="og:type" content="website">
  <meta property="og:title" content="Arriendo de Box Médico por Hora — Interés">
  <meta property="og:description" content="Formulario de interés para médicos que buscan arriendo de box/consulta por hora en Santiago (Providencia, Las Condes, Ñuñoa, La Florida).">
  <meta property="og:site_name" content="Box Médico por Hora">
  <meta property="og:image" content="og-image.svg">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="icon" href="assets/logo.svg" type="image/svg+xml">
  <style>
:root{--bg:#0b1020;--card:#111633;--muted:#98a3cf;--text:#e9edff;--accent:#7cc4ff;--ok:#59d18c}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial;background:linear-gradient(180deg,#0b1020,#0b1020 30%,#0f1730);color:var(--text)}
header{padding:28px 16px 18px;text-align:center;border-bottom:1px solid rgba(124,196,255,.15)}
.brand{display:flex;gap:10px;align-items:center;justify-content:center}
.brand img{height:40px}.tag{font-size:12px;border:1px dashed rgba(124,196,255,.35);padding:2px 6px;border-radius:8px;color:#cbd7ff}
h1{margin:10px 0 6px;font-size:clamp(22px,3.8vw,36px)}.sub{margin:4px 0 0;color:#98a3cf}
.container{max-width:980px;margin:24px auto 60px;padding:0 16px}
.card{background:linear-gradient(180deg,#101634,#0d1330); border:1px solid rgba(124,196,255,.22); border-radius:16px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,.25)}
.grid{display:grid;gap:16px}
@media(min-width:880px){.grid-cols-2{grid-template-columns:1fr 1fr}}
label{display:block;font-size:14px;color:#cfd6ff;margin:10px 0 6px}
input[type=text],input[type=email],input[type=tel],select{width:100%;padding:12px 14px;border-radius:10px;border:1px solid rgba(124,196,255,.25);background:#0b1128;color:var(--text);outline:none}
.row{display:flex;flex-wrap:wrap;gap:10px}
.chip{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;border:1px solid rgba(124,196,255,.25);background:#0b1128;cursor:pointer}
.chip input{accent-color:#5fb7ff}
.btns{display:flex;gap:10px;align-items:center;margin-top:14px}
button,.btn{border:none;cursor:pointer;padding:12px 16px;border-radius:12px;background:linear-gradient(180deg,#52b4ff,#2a91ff);color:#fff;font-weight:700}
button.secondary{background:transparent;border:1px solid rgba(124,196,255,.35)}
.success{display:none;margin-top:14px;padding:12px;border:1px solid rgba(89,209,140,.5);background:rgba(89,209,140,.08);color:#caffdf;border-radius:12px}
.footer{margin-top:22px;font-size:12px;color:#98a3cf}
a{color:#9cd3ff}
.center{text-align:center}
main.narrow{max-width:780px;margin:24px auto 60px;padding:0 16px}
</style>
</head>
<body>
  <header>
    <div class="brand">
      <img src="assets/logo.svg" alt="Logo">
      <div>
        <div class="tag">Piloto</div>
        <h1>Arriendo de Box Médico por Hora — Interés</h1>
        <p class="sub">Cuéntanos tu especialidad, comunas y horarios preferidos. Activamos cupos donde haya mayor demanda.</p>
      </div>
    </div>
  </header>
  <main class="container">
    <div class="grid grid-cols-2">
      <section class="card">
        <h2>1) Tus preferencias</h2>
        <form id="leadForm">
          <label for="especialidad">Especialidad</label>
          <select id="especialidad" required>
            <option value="">Selecciona…</option>
            <option>Dermatología</option>
            <option>Ginecología</option>
            <option>Pediatría</option>
            <option>Medicina familiar/general</option>
            <option>Psiquiatría</option>
            <option>Endocrinología</option>
            <option>Cardiología (consulta)</option>
            <option>Reumatología</option>
            <option>Alergología</option>
            <option>Otorrinolaringología</option>
            <option>Neurología (consulta)</option>
            <option>Traumatología (consulta)</option>
            <option>Medicina del trabajo</option>
            <option>Nutrición</option>
            <option>Psicología</option>
            <option>Estética médica</option>
            <option>Urología (consulta)</option>
            <option>Gastroenterología (consulta)</option>
            <option>Oftalmología</option>
            <option>Otra</option>
          </select>

          <label>Comunas de interés (elige 1–2)</label>
          <div class="row" id="comunas">
            <label class="chip"><input type="checkbox" value="Providencia"> Providencia</label>
            <label class="chip"><input type="checkbox" value="Las Condes"> Las Condes</label>
            <label class="chip"><input type="checkbox" value="Ñuñoa"> Ñuñoa</label>
            <label class="chip"><input type="checkbox" value="La Florida"> La Florida</label>
            <label class="chip"><input type="checkbox" value="Otra"> Otra</label>
          </div>
          <input type="text" id="comunaOtra" placeholder="Si marcaste Otra, escribe aquí" />

          <label>Franjas deseadas</label>
          <div class="row">
            <label class="chip"><input type="checkbox" value="AM" name="franjas"> AM</label>
            <label class="chip"><input type="checkbox" value="Mediodía" name="franjas"> Mediodía</label>
            <label class="chip"><input type="checkbox" value="PM" name="franjas"> PM</label>
            <label class="chip"><input type="checkbox" value="Sábado" name="franjas"> Sábado</label>
          </div>

          <label>Modalidad preferida</label>
          <div class="row">
            <label class="chip"><input type="radio" name="modalidad" value="Hora suelta" required> Hora suelta</label>
            <label class="chip"><input type="radio" name="modalidad" value="Packs"> Packs</label>
            <label class="chip"><input type="radio" name="modalidad" value="Mensual"> Mensual</label>
          </div>

          <label>Requisitos indispensables</label>
          <div class="row">
            <label class="chip"><input type="checkbox" value="Lavamanos" name="req"> Lavamanos</label>
            <label class="chip"><input type="checkbox" value="Secretaría/Agenda" name="req"> Secretaría/Agenda</label>
            <label class="chip"><input type="checkbox" value="TPV" name="req"> TPV</label>
            <label class="chip"><input type="checkbox" value="Estacionamiento" name="req"> Estacionamiento</label>
          </div>
          <input type="text" id="reqOtro" placeholder="Otro requisito (opcional)" />

          <label for="tarifa">Tarifa de tu consulta (referencial, CLP)</label>
          <input type="text" id="tarifa" inputmode="numeric" placeholder="Ej.: 30000" />
      </section>

      <section class="card">
        <h2>2) Contacto y envío</h2>
          <label for="nombre">Nombre</label>
          <input type="text" id="nombre" required placeholder="Nombre y apellido" />

          <label for="whatsapp">WhatsApp</label>
          <input type="tel" id="whatsapp" placeholder="+56 9 xxxx xxxx" />

          <label for="email">Email</label>
          <input type="email" id="email" required placeholder="nombre@dominio.com" />

          <div class="row" style="margin-top:8px">
            <label class="chip"><input type="checkbox" id="privacy" required> Acepto el <a href="privacidad.html" target="_blank">aviso de privacidad</a></label>
          </div>

          <div class="btns">
            <button type="submit">Enviar</button>
            <button class="secondary" id="btnWhatsApp" type="button">Enviar por WhatsApp</button>
            <a class="btn" id="btnDescargarCSV" download style="display:none">Descargar CSV</a>
          </div>
          <div class="success" id="successBox">¡Gracias! Tu registro fue capturado. Redirigiendo a la página de gracias…</div>
          <p class="footer">Campos ocultos: utm_source, utm_medium, utm_campaign, utm_content (se capturan automáticamente si vienen en la URL).</p>
        </form>
      </section>
    </div>
  </main>
  <script>
    const WHATSAPP_PHONE = "56998631064";
    const $=(q,ctx=document)=>ctx.querySelector(q); const $$=(q,ctx=document)=>Array.from(ctx.querySelectorAll(q));
    const params = new URLSearchParams(location.search);
    const UTM={utm_source:params.get('utm_source')||'',utm_medium:params.get('utm_medium')||'',utm_campaign:params.get('utm_campaign')||'',utm_content:params.get('utm_content')||''};

    function csvEscape(v){if(v==null) return ''; const s=String(v); return /[",\n]/.test(s)?'"'+s.replace(/"/g,'""')+'"':s}
    function toCSVRow(a){return a.map(csvEscape).join(',')+'\n'}
    function pickComunas(){const picked=$$('#comunas input:checked').map(i=>i.value); if(picked.includes('Otra') && $('#comunaOtra').value.trim()) picked.push($('#comunaOtra').value.trim()); return picked.filter(v=>v!=='Otra')}
    function buildPayload(){
      const ts=new Date().toISOString();
      const especialidad=$('#especialidad').value;
      const comunas=pickComunas();
      const franjas=$$('input[name=\"franjas\"]:checked').map(i=>i.value);
      const modalidad=($('input[name=\"modalidad\"]:checked')||{}).value||'';
      const reqs=$$('input[name=\"req\"]:checked').map(i=>i.value);
      if($('#reqOtro').value.trim()) reqs.push($('#reqOtro').value.trim());
      return {
        timestamp:ts,especialidad,comunas,
        franja_AM:franjas.includes('AM')?1:0,
        franja_Mediodia:franjas.includes('Mediodía')?1:0,
        franja_PM:franjas.includes('PM')?1:0,
        franja_Sabado:franjas.includes('Sábado')?1:0,
        modalidad,requisitos:reqs.join(' | '),tarifa:$('#tarifa').value.trim(),
        nombre:$('#nombre').value.trim(),whatsapp:$('#whatsapp').value.trim(),email:$('#email').value.trim(),...UTM
      };
    }

    // Submit -> download CSV + redirect
    $('#leadForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      if(!$('#especialidad').value){ alert('Selecciona tu especialidad'); return; }
      if(!$('#privacy').checked){ alert('Debes aceptar el aviso de privacidad'); return; }
      const p = buildPayload();
      const principal = p.comunas[0]||''; const secundaria = p.comunas[1]||'';
      const contacto = [p.nombre,p.whatsapp,p.email].filter(Boolean).join(' | ');
      const header = ['Timestamp','Especialidad','Comuna principal','Comuna secundaria','AM','Mediodía','PM','Sábado','Modalidad','Requisitos','Contacto','UTM_source','UTM_medium','UTM_campaign','UTM_content'];
      const row = [p.timestamp,p.especialidad,principal,secundaria,p.franja_AM,p.franja_Mediodia,p.franja_PM,p.franja_Sabado,p.modalidad,p.requisitos,contacto,p.utm_source,p.utm_medium,p.utm_campaign,p.utm_content];
      const csv = toCSVRow(header)+toCSVRow(row);
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = $('#btnDescargarCSV');
      a.href = url; a.download = `lead_${Date.now()}.csv`; a.style.display = 'inline-flex';
      $('#successBox').style.display = 'block';
      setTimeout(()=>{ location.href = 'gracias.html'; }, 1200);
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push({event:'lead_submit', especialidad:p.especialidad, comuna_principal:principal});
    });

    // WhatsApp prefill
    $('#btnWhatsApp').addEventListener('click', ()=>{
      const p = buildPayload();
      if(!p.especialidad){ alert('Selecciona tu especialidad'); return; }
      const principal = p.comunas[0]||'(sin comuna)';
      const msg = encodeURIComponent(`Hola, soy ${p.nombre||'(sin nombre)'} — ${p.especialidad}.\nComunas: ${p.comunas.join(', ')||principal}.\nFranjas: ${['AM',p.franja_Mediodia?'Mediodía':'',p.franja_PM?'PM':'',p.franja_Sabado?'Sábado':''].filter(Boolean).join(', ')}.\nModalidad: ${p.modalidad||'(no indica)'}.\nRequisitos: ${p.requisitos||'(ninguno)'}\nTarifa referencial: ${p.tarifa||'(s/i)'}\nContacto: ${p.email}${p.whatsapp?(' / '+p.whatsapp):''}`);
      const phone = "56998631064".trim();
      const wa = phone ? `https://wa.me/${phone}?text=${msg}` : `https://wa.me/?text=${msg}`;
      window.open(wa, '_blank');
    });
  </script>
</body>
</html>
